p = data.frame(lapply(poison, function(v) {
if (is.numeric(v)) return(v)
if (levels(v)[1] == levels(poison$Sex)[1]) return(v)
sapply(strsplit(as.character(v), "_"), function(s) return(s[2]))
}))
formattable(p)
summary(p)
acm <- MCA(
poison,
quanti.sup = 1:2, # Variables quantitatives supplémentaires
quali.sup = 3:4,  # Variables qualitatives supplémentaires
graph=FALSE)
formattable(
round(
setNames(
data.frame(acm$eig),
c("Valeur propre", "Variance (%)", "Cumulée (%)")), 2),
row.names = TRUE
)
par(mar = c(2, 2, 1, 1) + .5)
b = barplot(acm$eig[, 2],
names.arg = 1:nrow(acm$eig),
col ="darkslategray")
lines(b[-11], acm$eig[-11,2] - acm$eig[-1,2],
type = "b", pch = 19, col = "red")
legend("topright", col = "red", lty = 1, legend = "Saut", bty = "n", pch = 19)
par(mfrow = c(1, 2))
plot(acm, invisible = c("var", "quali.sup", "quanti.sup"),
autoLab = "yes")
plot(acm, invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes")
plot(acm, invisible = c("quali.sup", "quanti.sup"),
autoLab = "yes")
plotellipses(acm, keepvar = "quali")
plot(acm, choix = "var", invisible = c("quali.sup", "quanti.sup"))
par(mfrow = c(5, 4), mar = c(2, 2, 1, 0) + .1)
for (i in 1:4) {
for (j in 2:5) {
plot(acm,
axes = c(i, j),
title = paste(i, "-", j),
invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes")
}
}
formattable(
data.frame(round(acm$var$contrib)),
list(
area() ~ proportion_bar("lightblue")
)
)
formattable(
data.frame(round(acm$ind$contrib)),
list(
area() ~ proportion_bar("lightblue")
)
)
plot(acm, invisible = c("ind", "var"), autoLab = "yes")
acm2 <- MCA(
poison,
quanti.sup = 1:2, # Variables quantitatives supplémentaires
quali.sup = c(3:4, 11),  # Variables qualitatives supplémentaires
graph = FALSE)
par(mar = c(2, 2, 1, 1) + .5)
b = barplot(acm2$eig[, 2],
names.arg = 1:nrow(acm2$eig),
col ="darkslategray")
lines(b[-10], acm2$eig[-10,2] - acm2$eig[-1,2],
type = "b", pch = 19, col = "red")
legend("topright", col = "red", lty = 1, legend = "Saut", bty = "n", pch = 19)
par(mfrow = c(5, 4), mar = c(2, 2, 1, 0) + .1)
for (i in 1:4) {
for (j in 2:5) {
plot(acm2,
axes = c(i, j),
title = paste(i, "-", j),
invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes")
}
}
plot(acm2, invisible = c("ind", "var"), autoLab = "yes")
i
j
plot(acm2,
axes = c(i, j),
title = paste(i, "-", j),
invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes")
par(mfrow = c(5, 4), mar = c(2, 2, 1, 0) + .1)
for (i in 1:4) {
for (j in 2:5) {
plot(acm2,
axes = c(i, j),
title = paste(i, "-", j),
invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes")
}
}
par(mfrow = c(5, 4), mar = c(2, 2, 1, 0) + .1)
for (i in 1:4) {
for (j in 2:5) {
plot(acm2,
axes = c(i, j),
title = paste(i, "-", j),
invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes")
}
}
print(plot(acm2,
axes = c(i, j),
title = paste(i, "-", j),
invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes"))
par(mfrow = c(5, 4), mar = c(2, 2, 1, 0) + .1)
for (i in 1:4) {
for (j in 2:5) {
print(plot(acm2,
axes = c(i, j),
title = paste(i, "-", j),
invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes"))
}
}
par(mfrow = c(5, 4), mar = c(2, 2, 1, 0) + .1)
for (i in 1:4) {
for (j in 2:5) {
print(plot(acm2,
axes = c(i, j),
title = paste(i, "-", j),
invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes"))
}
}
?ggrepel
class(acm2)
plot.MCA
?plot.MCA
length(list())
length(list(12))
length(list(1:2))
list(1:2)
liste = list()
for (i in 1:4) {
for (j in 2:5) {
liste[[length(liste) + 1]] = plot(acm2,
axes = c(i, j),
title = paste(i, "-", j),
invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes")
}
}
do.call(grid.arrange, p)
liste = list()
for (i in 1:4) {
for (j in 2:5) {
liste[[length(liste) + 1]] = plot(acm2,
axes = c(i, j),
title = paste(i, "-", j),
invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes")
}
}
do.call(grid.arrange, liste)
library(gridExtra)
liste = list()
for (i in 1:4) {
for (j in 2:5) {
liste[[length(liste) + 1]] = plot(acm2,
axes = c(i, j),
title = paste(i, "-", j),
invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes")
}
}
do.call(grid.arrange, liste)
library(gridExtra)
liste = list()
for (i in 1:4) {
for (j in 2:5) {
liste[[length(liste) + 1]] = plot(acm2,
axes = c(i, j),
title = paste(i, "-", j),
invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes")
}
}
do.call(grid.arrange, liste)
library(gridExtra)
liste = list()
for (i in 1:4) {
for (j in (i+1):5) {
liste[[length(liste) + 1]] = plot(acm2,
axes = c(i, j),
title = paste(i, "-", j),
invisible = c("ind", "quali.sup", "quanti.sup"),
autoLab = "yes")
}
}
do.call(grid.arrange, liste)
children
USAccDeaths
ca(USAccDeaths)
CA(USAccDeaths)
library(FactoMineR)
CA(USAccDeaths)
CA(as.matrix(USAccDeaths))
(as.matrix(USAccDeaths))
matrix(USAccDeaths)
matrix(USAccDeaths, nrow = 6)
matrix(USAccDeaths, nrow = 6, byrow = FALSE)
matrix(USAccDeaths, nrow = 6, byrow = TRUE)
USAccDeaths
CA(matrix(USAccDeaths, nrow = 6, byrow = TRUE))
?USAccDeaths
m = matrix(USAccDeaths, nrow = 6, byrow = TRUE)
m
names(USAccDeaths)
colnames(USAccDeaths)
attributes(USAccDeaths)
m = as.data.frame(matrix(USAccDeaths, nrow = 6, byrow = TRUE))
m
rownames(m) = 1973:1978
colnames(m) = month.name
m
USAccDeaths
m %>% rownames_to_column()
m %>% rownames_to_column() %>% write.csv(file = "USAccDeaths.csv")
setwd("~/Documents/GitHub/cours-2021-2022/insa-ms-esd--ml")
m %>% rownames_to_column() %>% write.csv(file = "USAccDeaths.csv", row.names = FALSE)
m %>% rownames_to_column("Year") %>% write.csv(file = "USAccDeaths.csv", row.names = FALSE)
Titanic
unlist(Titanic)
as.data.frame(Titanic)
data.frame(Titanic)
df = data.frame(Titanic)
df.select(Freq > 0)
df.subset(Freq > 0)
subset(df, Freq > 0)
df = subset(data.frame(Titanic), Freq > 0)
df_cible = subset(df, Freq = 0)
df_cible
df_cible = subset(df, Freq == 0)
df_cible
df_cible = rbind(df_cible, df[i,])
for (i in 1:nrow(df)) {
for (i in 1:df$Freq[i]) {
df_cible = rbind(df_cible, df[i,])
}
}
df_cible
df = subset(data.frame(Titanic), Freq > 0)
df_cible = subset(df, Freq = 0)
for (i in 1:3) {
for (i in 1:df$Freq[i]) {
df_cible = rbind(df_cible, df[i,])
}
}
df_cible
rbind(df[1,], df[5])
rbind(df[1,], df[5,])
df$Freq[1]
df = subset(data.frame(Titanic), Freq > 0)
df_cible = subset(df, Freq = 0)
for (i in 1:3) {
for (j in 1:df$Freq[i]) {
df_cible = rbind(df_cible, df[i,])
}
}
df_cible
dim(df_cible)
df = subset(data.frame(Titanic), Freq > 0)
df_cible = subset(df, Freq = 0)
for (i in 1:nrow(df)) {
for (j in 1:df$Freq[i]) {
df_cible = rbind(df_cible, df[i,])
}
}
df_cible
dim(df_cible)
sum(Titanic)
sum(df$Freq)
1:1
for (j in 1:1) print(j)
df = subset(data.frame(Titanic), Freq > 0)
df_cible = subset(df, Freq = 0)
for (i in 1:3) {
for (j in 1:df$Freq[i]) {
df_cible = rbind(df_cible, df[i,])
}
}
df_cible
df = subset(data.frame(Titanic), Freq > 0 & Freq < 3)
df
df = subset(data.frame(Titanic), Freq > 0 & Freq <= 5)
df
df = subset(data.frame(Titanic), Freq > 0 & Freq <= 5)
df_cible = subset(df, Freq = 0)
for (i in 1:3) {
for (j in 1:df$Freq[i]) {
df_cible = rbind(df_cible, df[i,])
}
}
df_cible
df = subset(data.frame(Titanic), Freq > 0 & Freq <= 5)
df_cible = subset(df, Freq = 0)
for (i in 1:3) {
cat("\n\n\ni = ", i, "***********************************\n")
for (j in 1:df$Freq[i]) {
df_cible = rbind(df_cible, df[i,])
print(df_cible)
}
}
df_cible
df = subset(data.frame(Titanic), Freq > 0 & Freq <= 5)
df_cible = subset(df, Freq < 0)
for (i in 1:3) {
cat("\n\n\ni = ", i, "***********************************\n")
for (j in 1:df$Freq[i]) {
df_cible = rbind(df_cible, df[i,])
print(df_cible)
}
}
df_cible
df
df = subset(data.frame(Titanic), Freq > 0 & Freq <= 5)
df_cible = subset(df, Freq < 0)
for (i in 1:nrow(df)) {
cat("\n\n\ni = ", i, "***********************************\n")
for (j in 1:df$Freq[i]) {
df_cible = rbind(df_cible, df[i,])
print(df_cible)
}
}
df_cible
df = subset(data.frame(Titanic), Freq > 0)
df_cible = subset(df, Freq < 0)
for (i in 1:nrow(df)) {
cat("\n\n\ni = ", i, "***********************************\n")
for (j in 1:df$Freq[i]) {
df_cible = rbind(df_cible, df[i,])
print(df_cible)
}
}
df_cible
df = subset(data.frame(Titanic), Freq > 0)
df_cible = subset(df, Freq < 0)
for (i in 1:nrow(df)) {
for (j in 1:df$Freq[i]) {
df_cible = rbind(df_cible, df[i,])
}
}
df_cible
dim(df_cible)
sum(Titanic)
sample(df_cible)
df_cible
permute(1:10)
sample(1:10)
df_cible[sample(1:nrow(df_cible))]
df_cible[sample(1:nrow(df_cible)),]
write.csv(df_cible[sample(1:nrow(df_cible)),], file = "titanic.csv", row.names = FALSE)
df_cible$Freq = NULL
write.csv(df_cible[sample(1:nrow(df_cible)),], file = "titanic.csv", row.names = FALSE)
library(readxl)
getwd()
data = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls")
?read_excel
data = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls", sheet = "DEP_2014")
data
data = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls", sheet = "DEP_2014", skip = 13)
data
noms = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls", sheet = "DEP_2014", skip = 12, n_max = 1)
noms
noms = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls", sheet = "DEP_2014", skip = 12, n_max = 2, col_names = FALSE)
noms
noms = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls", sheet = "DEP_2014", skip = 12, n_max = 2, col_names = FALSE) %>% transpos()
noms = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls", sheet = "DEP_2014", skip = 12, n_max = 2, col_names = FALSE) %>% transpose()
noms = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls", sheet = "DEP_2014", skip = 12, n_max = 2, col_names = FALSE) %>% t()
noms
data = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls", sheet = "DEP_2014", skip = 12)
data
data = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls", sheet = "DEP_2014", skip = 12) %>%
slice(-1)
library(dplyr)
data = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls", sheet = "DEP_2014", skip = 12) %>%
slice(-1)
data
data %>% group_by(Région) %>%
summarise_all(sum)
?summarise_all
data %>%
select(-Département, -`Libellé de département`) %>%
group_by(Région) %>%
summarise_all(sum)
data %>%
select(-Département, -`Libellé de\n département`) %>%
group_by(Région) %>%
summarise_all(sum)
data %>%
select(-Département, -`Libellé de
département`) %>%
group_by(Région) %>%
summarise_all(sum)
data %>%
select(-Département, -`Libellé de
département`) %>%
group_by(Région) %>%
summarise_all(sum)
names(data)
library(stringr)
str_replace(names(data), "\n", " ")
?str_replace
str_replace_all(names(data), "\n", " ")
data = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls", sheet = "DEP_2014", skip = 12) %>%
slice(-1)
names(data) = str_replace_all(names(data), "\n", " ")
data %>%
select(-Département, -`Libellé de département`) %>%
group_by(Région) %>%
summarise_all(sum)
data %>%
select(-Département, -`Libellé de département`)
data %>%
select(-Département, -`Libellé de département`) %>%
group_by(Région) %>%
summarise_all(sum)
tail(data)
data$`Agriculteurs Actifs ayant un emploi RP2014`
sum(data$`Agriculteurs Actifs ayant un emploi RP2014`)
?read_excel
data = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls",
sheet = "DEP_2014", skip = 12,
col_types = "guess") %>%
slice(-1)
names(data) = str_replace_all(names(data), "\n", " ")
data %>%
select(-Département, -`Libellé de département`) %>%
group_by(Région) %>%
summarise_all(sum)
data = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls",
sheet = "DEP_2014", skip = 12,
col_types = "numeric") %>%
slice(-1)
names(data) = str_replace_all(names(data), "\n", " ")
data %>%
select(-Département, -`Libellé de département`) %>%
group_by(Région) %>%
summarise_all(sum)
regions = read_csv("/Users/fxjollois/Downloads/region2020.csv")
library(tidyr)
regions = read_csv("/Users/fxjollois/Downloads/region2020.csv")
?read.csv
?read_csv
??read_csv
library(readr)
regions = read_csv("/Users/fxjollois/Downloads/region2020.csv")
regions
res = data %>%
select(-Département, -`Libellé de département`) %>%
group_by(Région) %>%
summarise_all(sum)
res
regions = read_csv("/Users/fxjollois/Downloads/region2020.csv") %>%
mutate(Région = as.integer(reg))
regions
res %>% inner_join(regions)
regions %>% inner_join(res)
regions %>% inner_join(res) %>%
select(-cheflieu, tncc, ncc, nccenr)
regions %>% inner_join(res) %>%
select(-cheflieu, -tncc, -ncc, -nccenr)
regions %>% inner_join(res) %>%
select(-cheflieu, -tncc, -ncc, -nccenr, -reg, -Région)
regions %>% inner_join(res) %>%
select(-cheflieu, -tncc, -ncc, -nccenr, -reg, -Région) %>%
rename(libelle = "Région")
regions %>% inner_join(res) %>%
select(-cheflieu, -tncc, -ncc, -nccenr, -reg, -Région) %>%
rename(Région = libelle)
regions = read_csv("/Users/fxjollois/Downloads/region2020.csv") %>%
mutate(Région = as.integer(reg)) %>%
filter(Région > 5)
regions
regions = read_csv("/Users/fxjollois/Downloads/region2020.csv") %>%
mutate(Région = as.integer(reg)) %>%
filter(Région > 10)
regions %>% inner_join(res) %>%
select(-cheflieu, -tncc, -ncc, -nccenr, -reg, -Région) %>%
rename(Région = libelle)
write_csv(final, file = "regions-csp-2014.csv")
final = regions %>% inner_join(res) %>%
select(-cheflieu, -tncc, -ncc, -nccenr, -reg, -Région) %>%
rename(Région = libelle)
write_csv(final, file = "regions-csp-2014.csv")
data = read_excel("/Users/fxjollois/Downloads/pop-act2554-csp-cd-6814.xls",
sheet = "DEP_1968", skip = 12,
col_types = "numeric") %>%
slice(-1)
names(data) = str_replace_all(names(data), "\n", " ")
res = data %>%
select(-Département, -`Libellé de département`) %>%
group_by(Région) %>%
summarise_all(sum)
regions = read_csv("/Users/fxjollois/Downloads/region2020.csv") %>%
mutate(Région = as.integer(reg)) %>%
filter(Région > 10)
final = regions %>% inner_join(res) %>%
select(-cheflieu, -tncc, -ncc, -nccenr, -reg, -Région) %>%
rename(Région = libelle)
final
write_csv(final, file = "regions-csp-1968.csv")
names(final)
